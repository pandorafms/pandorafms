# Base config file for Pandora FMS Windows Agent
# (c) 2006-2010 Artica Soluciones Tecnologicas 
# version 3.2

# This program is Free Software, you can redistribute it and/or modify it
# under the terms of the GNU General Public Licence as published by the Free Software
# Foundation; either version 2 of the Licence or any later version
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY, without ever the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE

# Edit this file to change your parameters or/and add your own modules
# Any line with a # character at the first column will be ignored (comment)

# General Parameters
# ==================

# NOTE: The variables $*$ will be substituted in the installation wizard

server_ip $ServerIP$
server_path /var/spool/pandora/data_in
temporal "$AgentTemp$"

#include "C:\Archivos de programa\pandora_agent\pandora_agent_alt.conf"
#broker_agent name_agent

# Agent uses your hostname automatically, if you need to change agent name
# use directive agent_name (do not use blank spaces, please).
# This parameter is CASE SENSITIVE.

# agent_name My_Custom_Agent_name

# address: Enforce to server a ip address to this agent 
# You can also try to detect the first IP using "auto", for example

#address auto
# or setting a fixed IP address, like for example:
#address 192.168.36.73

# Group assigned for this agent (descriptive, p.e: Servers)
group "$AgentGroup$"

# This limits operation if temporal dir has not enough free disk.
#temporal_min_size 1024

# Delay start execution X second before start to minonitoring nothing 
#startup_delay 30

# Interval is defined in seconds
interval 300

# tranfer_modes: Possible values are local, tentacle (default), ftp and ssh.
transfer_mode tentacle
server_port 41121

# In case of using FTP or tentacle with password. User is always "pandora"
#server_pwd pandora

# Debug mode do not copy XML data files to server.
# debug 1

# ODBC connections. Check documentation for more information.
# Configuring "ExampleDSN" DSN. Notice that this DSN connection must be configured
# under Control panel -> Administrative tools -> ODBC -> DSN
# odbc_ExampleDSN_username UserNameForDsn
# odbc_ExampleDSN_password Password1234

# If set to 1 allows the agent to be configured via the web console 
# (only works on enterprise version).
# remote_config 1

# Set XML encoding (ISO-8859-1 by default).
#encoding ISO-8859-1

# If set to 1 start Drone Agent's Proxy Mode 
# proxy_mode 1

# Max number of simmultaneus connection for proxy (by default 10)
# proxy_max_connection 10

# Proxy timeout (by default 1s)
# proxy_timeout 1

# Enable or disable XML buffer.
xml_buffer 0

# Secondary server configuration
# ==============================

# If secondary_mode is set to on_error, data files are copied to the secondary
# server only if the primary server fails. If set to always, data files are
# always copied to the secondary server.
#secondary_mode on_error
#secondary_server_ip localhost
#secondary_server_path /var/spool/pandora/data_in
#secondary_server_port 41121
#secondary_transfer_mode tentacle
#secondary_server_pwd mypassword
#secondary_server_ssl no
#secondary_server_opts

# Module Definition
# Check online documentation and module library at http://pandorafms.org
# =================

# Sample of Windows inventory module (ONLY ENTERPRISE)!
#module_begin
#module_name Inventory
#module_interval 7
#module_type generic_data_string
#module_inventory RAM Patches Software Services NIC
#module_description Inventory
#module_end

# Example plugin to retrieve last 5 min events in log4x format
# module_plugin cscript.exe //B "%ProgramFiles%\Pandora_Agent\util\logevent_log4x.vbs" Aplicacion System 300

# Example plugin to retrieve drive usage
# module_plugin cscript.exe //B "%ProgramFiles%\Pandora_Agent\util\df.vbs"

# Free space on disk C: (%)
module_begin
module_name FreeDiskC
module_type generic_data
module_freepercentdisk C:
module_description Free space on drive C: (%)
module_end

# Free space on disk D: (%)
# module_begin
# module_name FreeDiskD
# module_type generic_data
# module_freepercentdisk D:
# module_description Free space on drive D: (%)
# module_end

# Free space on disk C: (Total)
# module_begin
# module_name FreeDiskCTotal
# module_type generic_data
# module_freedisk C:
# module_description Free space on drive C: (Total)
# module_end

# CPU usage percentage
module_begin
module_name CPUUse
module_type generic_data
module_cpuusage all
module_description CPU# usage
module_end

# Free Memory
module_begin
module_name FreeMemory
module_type generic_data
module_freepercentmemory
module_description Amount of free memory.
module_end

# Log events
module_begin
module_name System Events (TermService)
module_type async_string
module_logevent
module_description Log Events coming from Terminal Service
module_source System
module_application TermService
module_end

module_begin
module_name Security Events (Invalid Login)
module_type async_string
module_description Security log events for invalid login attempt
module_logevent
module_source Security
module_eventcode 529
module_end

# Sample on how to get a value from registry
# This returns the last time user launch microsoft Windows update
#module_begin
#module_name Windows_Update_LastRun
#module_type generic_data_string
#module_exec getreg LM "SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update" SetupWizardLaunchTime
#module_description Last date and time user launch microsoft Windows update
#module_end

# Example of a remote TCP check
#module_begin
#module_name Tcp Sample check
#module_type generic_data
#module_tcpcheck www.google.com
#module_port 80
#module_timeout 5
#module_end

# Example of regexp matching
#module_begin
#module_name PandoraAgent_log
#module_type generic_data_string
#module_regexp C:\archivos de programa\pandora_agent\pandora_agent.log
#module_description This module will return all lines from the specified logfile
#module_pattern .*
#module_end

# Get processor time from Performance Counter (SPANISH only, check your 
# locale string) using the Windows Performance tool to 
# identify proper PerCounter strings. Check documentation for detailed steps.
#module_begin
#module_name Processor_Time
#module_type generic_data
#module_perfcounter \Procesador(_Total)\% de tiempo de procesador
#module_end

# Example of module exec, used to know about the memory used by pandora process
# grep.exe and gawk.exe are included in the util directory of the agent.
#module_begin
#module_name PandoraFMS RAM
#module_type generic_data
#module_exec tasklist | grep Pandora | gawk "{ print $5 }" | tr -d "."
#module_end

# Example of module exec, used get number of active terminal services sessions
# Works on Windows 2003. In Windows XP the query.exe and quser.exe files were
# moved to %WINDIR%\system32\dllcache. If XP, copy the exe to %WINDIR%\system32
#module_begin
#module_name Active TS Sessions
#module_type generic_data_string
#module_exec query session | grep Activ | gawk "{ print $2 }" |wc -l
#module_description Number of active TS Sessions
#module_end

# Example of watchdog process opening it if it gets closed
# NOTE: This need to enable "Service can interactuate with the deskop" option
# in the Pandora FMS Service configuration (Windows Service Control management).
#module_begin
#module_name TaskManager
#module_type generic_proc
#module_proc taskmgr.exe
#module_description This keeps taskmgr always running in the system
#module_async yes
#module_watchdog yes
#module_start_command c:\windows\system32\taskmgr.exe
#module_end

# Example of watchdog service opening it if it gets closed
#module_begin
#module_name ServiceVNC_Server
#module_type generic_proc
#module_service winvnc
#module_description Service VNC Server watchdog/service
#module_async yes
#module_watchdog yes
#module_end

# Example UDP server to be able to execute remote actions such
# as starting or stopping process.
#udp_server 1
#udp_server_port 4321
#udp_server_auth_address 192.168.1.23
#process_firefox_start firefox
#process_firefox_stop killall firefox
#service_messenger 1

# Example of preconditions
#module_begin
#module_name Prueba Precondicion
#module_type generic_data
#module_precondition < 10 type X:\fichero.txt | wc -l
#module_freepercentmemory
#module_description Amount of free memory.
#module_end

